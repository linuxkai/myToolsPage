import{E as ne,_ as re,c as de,h as ue,b as pe,d as ce,f as _e,a as me,g as fe}from"./FooterLayout.vue_vue_type_style_index_0_lang-C_7nl70_.js";import{E as ge}from"./el-scrollbar-CCiQDK9S.js";import{l as W,f as D,E as he,a as ve,b as be,Y as ye}from"./lodash-jJypNp2n.js";import{E as U,a as we}from"./el-input-D4edLIWB.js";import{E as xe,a as Ce}from"./el-select-DLIAD7B6.js";import{E as ze}from"./el-button-BJOHKKgZ.js";import{E as Ve}from"./el-checkbox-CwR03m6R.js";import{d as ke,r as h,n as L,b as o,e as v,o as k,a as e,f as s,g as Ee,m as Se,u as a,l as m,z as I,t as b,c as Re,A as je,y as N,p as Ue,h as Le,_ as Ie}from"./index-ChpREGtw.js";import"./strings-Buso_W90.js";const r=x=>(Ue("data-v-d01811d8"),x=x(),Le(),x),Ne=r(()=>s("div",{class:"card-header"},[s("span",null,"图片压缩/裁剪")],-1)),Be={class:"card-body"},Pe={class:"model-show border"},$e=["src"],He=r(()=>s("label",{class:"fs-5"},"参数调整: ",-1)),Me={class:"cropper-size"},Te=r(()=>s("label",{class:"el-text me-1"},"裁剪框大小:",-1)),We=r(()=>s("span",null," x ",-1)),De={class:"cropper-scale"},Oe=r(()=>s("span",null," x ",-1)),Ge={class:"fillcolor"},Fe=r(()=>s("label",{class:"el-text"},"超出裁剪框填充色: ",-1)),Je={class:"image-format w-100",style:{display:"flex"}},Ae=r(()=>s("label",{class:"el-text me-1",style:{width:"28%"}},"图片导出格式: ",-1)),Ye=r(()=>s("label",{class:"el-text"},"生成图片的质量: ",-1)),qe={class:"slider-block"},Ke=r(()=>s("label",{class:"el-text"},"导出图片预览: ",-1)),Qe=["src"],Xe={class:"origin-size"},Ze=r(()=>s("label",{class:"el-text me-1"},"原始图片信息:",-1)),et={class:"export-size"},tt=r(()=>s("label",{class:"el-text me-1"},"导出图片大小:",-1)),ot={key:0,class:"cropper"},lt={class:"btn-cropper"},st=r(()=>s("span",null,"放大",-1)),at=r(()=>s("span",null,"缩小",-1)),it=r(()=>s("span",null,"左旋90°",-1)),nt=r(()=>s("span",null,"右旋90°",-1)),rt=r(()=>s("span",null,"重置旋转",-1)),dt=r(()=>s("span",null,"预览(blob)",-1)),ut=r(()=>s("span",null,"预览(base64)",-1)),pt=r(()=>s("div",{class:"el-upload__text"},[m(" 将图片拖拽到此处 "),s("em",null,"点此添加图片")],-1)),ct=r(()=>s("div",{class:"el-upload__tip"}," 支持图片格式: jpeg(jpg), png,webp ",-1)),_t=ke({__name:"imageCompress",setup(x){const c=h(),C=h({width:"100%",height:"100%",overflow:"hidden",display:"flex","align-items":"center","justify-content":"center",zoom:.5}),z=h(!1),y=h(""),B=h({html:"",div:"",url:"",img:""}),P={img:"",outputSize:1,outputType:"png",info:!0,canScale:!0,autoCrop:!0,autoCropWidth:750,autoCropHeight:480,fixed:!1,fixedNumber:[4,3],fixedBox:!1,canMove:!0,canMoveBox:!0,original:!0,centerBox:!1,high:!0,infoTrue:!1,maxImgSize:2e3,enlarge:1,mode:"contain",limitMinSize:10,fillColor:"rgba(255, 0, 0, 0)",predefineColors:["#e54d42","#fbbd08","#19be6b","#3a8ee6","#000000","rgba(229, 77, 66, 0.5)","rgba(251, 189, 8, 0.5)","rgba(25, 190, 107, 0.5)","rgba(58, 142, 230, 0.5)","rgba(0, 0, 0, 0.5)"],originSize:"",originWidth:0,originHeight:0,exportSize:"",exportWidth:0,exportHeight:0};var l=h(W.cloneDeep(P));async function $(i){const t=i.type==="image/jpeg",p=i.type==="image/png",d=i.size/1024/1024<20;if(!t&&!p){U.error("上传图片的格式只能是 JPG或PNG 格式!");return}if(!d){U.error("上传图片的大小不能超过 20M!");return}l.value.originSize=D(i.size);const f=await new Promise(function(E,S){let u=1920,w=1080,R=window.URL||window.webkitURL,_=new Image;_.onload=function(){l.value.originWidth=_.width,l.value.originHeight=_.height,_.width<=u&&_.height<=w?E(1):S()},_.src=R.createObjectURL(i),l.value.img=_.src}).then(()=>i,()=>(U.error("上传的图片宽高必须是320*320!"),Promise.reject()));return p&&t&&f&&d}function O(i){C.value={width:"100%",height:"100%",overflow:"hidden",display:"flex","align-items":"center","justify-content":"center",zoom:.5},l.value.exportWidth=i.w,l.value.exportHeight=i.h,(i.w>375||i.h>320)&&(i.w>i.h?C.value.zoom=375/i.w:C.value.zoom=320/i.h),c.value.getCropBlob(t=>{var p=window.URL.createObjectURL(t);y.value=p,l.value.exportSize=D(t.size)})}function H(i){l.value.outputType=="jpeg"&&l.value.fillColor=="red",i==="blob"?c.value.getCropBlob(t=>{var p=window.URL.createObjectURL(t);z.value=!0,y.value=p}):c.value.getCropData(t=>{z.value=!0,y.value=t})}function G(i){var t=document.createElement("a");t.download="shortcut",i==="blob"?c.value.getCropBlob(p=>{t.href=window.URL.createObjectURL(p),t.click()}):c.value.getCropData(p=>{t.href=p,t.click()})}function M(i){i=i||1,c.value.changeScale(i)}function F(){c.value.rotateLeft()}function J(){c.value.rotateRight()}function A(){c.value.rotateClear()}function Y(){l.value.fillColor="rgba(255, 0, 0, 0)"}function q(){var i=l.value.img;l.value=W.cloneDeep(P),l.value.img=i}return(i,t)=>{const p=re,d=de,f=we,E=Ve,S=he,u=ze,w=xe,R=Ce,_=ve,j=ue,T=be,V=pe,K=v("Plus"),g=ce,Q=v("Minus"),X=v("RefreshLeft"),Z=v("RefreshRight"),ee=v("Refresh"),te=v("upload-filled"),oe=ge,le=_e,se=me,ae=fe,ie=ne;return k(),L(ie,null,{default:o(()=>[e(p),e(le,null,{default:o(()=>[e(d,{gutter:20,justify:"center"},{default:o(()=>[e(V,{xl:16,lg:24,span:24},{default:o(()=>[e(oe,null,{header:o(()=>[Ne]),default:o(()=>[s("div",Be,[e(d,{class:"row"},{default:o(()=>[Ee(s("div",{class:"model",onClick:t[0]||(t[0]=n=>z.value=!1)},[s("div",Pe,[s("img",{src:y.value,alt:""},null,8,$e)])],512),[[Se,z.value]])]),_:1}),a(l).img?(k(),L(d,{key:0,class:"row",type:"flex"},{default:o(()=>[e(V,{xl:6,span:8,"min-width":"400px",style:{"padding-right":"30px"}},{default:o(()=>[e(d,{class:"row border-bottom",justify:"space-between"},{default:o(()=>[He]),_:1}),e(d,{class:"row",justify:"space-between"},{default:o(()=>[s("div",Me,[Te,e(f,{type:"number",modelValue:a(l).autoCropWidth,"onUpdate:modelValue":t[1]||(t[1]=n=>a(l).autoCropWidth=n),class:"pe-2","show-alpha":"",style:{width:"36%"},placeholder:"宽(px)"},null,8,["modelValue"]),We,e(f,{type:"number",modelValue:a(l).autoCropHeight,"onUpdate:modelValue":t[2]||(t[2]=n=>a(l).autoCropHeight=n),class:"ps-2",style:{width:"36%"},placeholder:"高(px)"},null,8,["modelValue"])])]),_:1}),e(d,{class:"row",justify:"space-between"},{default:o(()=>[s("div",De,[e(E,{modelValue:a(l).fixed,"onUpdate:modelValue":t[3]||(t[3]=n=>a(l).fixed=n),label:"是否锁定宽高比例:",class:"pe-3"},null,8,["modelValue"]),e(f,{type:"number",modelValue:a(l).fixedNumber[0],"onUpdate:modelValue":t[4]||(t[4]=n=>a(l).fixedNumber[0]=n),class:"pe-3",style:{width:"27%"},placeholder:"宽",disabled:!a(l).fixed},null,8,["modelValue","disabled"]),Oe,e(f,{type:"number",modelValue:a(l).fixedNumber[1],"onUpdate:modelValue":t[5]||(t[5]=n=>a(l).fixedNumber[1]=n),class:"ps-3",style:{width:"27%"},placeholder:"高",disabled:!a(l).fixed},null,8,["modelValue","disabled"])])]),_:1}),e(d,{class:"row",justify:"space-between"},{default:o(()=>[s("div",Ge,[Fe,e(S,{modelValue:a(l).fillColor,"onUpdate:modelValue":t[6]||(t[6]=n=>a(l).fillColor=n),predefine:a(l).predefineColors,"show-alpha":""},null,8,["modelValue","predefine"]),e(u,{class:"ms-2",size:"small",type:"primary",onClick:t[7]||(t[7]=n=>Y())},{default:o(()=>[m("清除颜色")]),_:1})])]),_:1}),e(d,{class:"row",justify:"space-between"},{default:o(()=>[s("div",Je,[Ae,e(R,{modelValue:a(l).outputType,"onUpdate:modelValue":t[8]||(t[8]=n=>a(l).outputType=n),style:{width:"72%"}},{default:o(()=>[e(w,{label:"jpeg",value:"jpeg"}),e(w,{label:"png",value:"png"}),e(w,{label:"webp",value:"webp"})]),_:1},8,["modelValue"])])]),_:1}),e(d,{class:"row"},{default:o(()=>[Ye,s("div",qe,[e(_,{modelValue:a(l).outputSize,"onUpdate:modelValue":t[9]||(t[9]=n=>a(l).outputSize=n),step:.1,max:1,size:"small"},null,8,["modelValue"])])]),_:1}),e(d,null,{default:o(()=>[Ke]),_:1}),e(d,{class:"row",style:{width:"100%",height:"30vh"}},{default:o(()=>[s("div",{style:I(C.value)},[s("div",{style:I(B.value.div)},[s("img",{src:y.value,style:I(B.value.img),"object-fit":"contain"},null,12,Qe)],4)],4)]),_:1}),e(d,{class:"row"},{default:o(()=>[s("div",Xe,[Ze,e(j,{class:"fst-italic",type:"info"},{default:o(()=>[m(" 大小: "+b(a(l).originSize)+", 尺寸: "+b(a(l).originWidth)+" x "+b(a(l).originHeight),1)]),_:1})]),s("div",et,[tt,e(j,{class:"fst-italic",type:"info"},{default:o(()=>[m(" 大小: "+b(a(l).exportSize)+", 尺寸: "+b(a(l).exportWidth)+" x "+b(a(l).exportHeight),1)]),_:1})])]),_:1}),e(d,{class:"row",justify:"space-between"},{default:o(()=>[e(T,{ref:"changeImage",action:"#","auto-upload":!0,"before-upload":$},{trigger:o(()=>[e(u,{type:"primary"},{default:o(()=>[m("更换图片")]),_:1})]),_:1},512),e(u,{type:"primary",onClick:t[10]||(t[10]=n=>G("blob"))},{default:o(()=>[m("保存图片")]),_:1}),e(u,{type:"primary",onClick:q},{default:o(()=>[m("重置参数")]),_:1})]),_:1})]),_:1}),e(V,{xl:18,span:16},{default:o(()=>[a(l).img?(k(),Re("div",ot,[e(a(ye),je({ref_key:"cropper",ref:c},a(l),{img:a(l).img,onRealTime:O,fillColor:a(l).fillColor}),null,16,["img","fillColor"])])):N("",!0),s("div",lt,[e(u,{type:"primary",onClick:t[11]||(t[11]=n=>M(1))},{default:o(()=>[e(g,{size:"18"},{default:o(()=>[e(K)]),_:1}),st]),_:1}),e(u,{type:"primary",onClick:t[12]||(t[12]=n=>M(-1))},{default:o(()=>[e(g,{size:"18"},{default:o(()=>[e(Q)]),_:1}),at]),_:1}),e(u,{type:"primary",onClick:t[13]||(t[13]=n=>F())},{default:o(()=>[e(g,{size:"18"},{default:o(()=>[e(X)]),_:1}),it]),_:1}),e(u,{type:"primary",onClick:J},{default:o(()=>[e(g,{size:"18"},{default:o(()=>[e(Z)]),_:1}),nt]),_:1}),e(u,{type:"primary",onClick:A},{default:o(()=>[e(g,{size:"18"},{default:o(()=>[e(ee)]),_:1}),rt]),_:1}),e(u,{type:"primary",onClick:t[14]||(t[14]=n=>H("blob"))},{default:o(()=>[dt]),_:1}),e(u,{type:"primary",onClick:t[15]||(t[15]=n=>H("base64"))},{default:o(()=>[ut]),_:1})])]),_:1})]),_:1})):N("",!0),a(l).img?N("",!0):(k(),L(d,{key:1,class:"upload row"},{default:o(()=>[e(V,{span:24},{default:o(()=>[e(T,{id:"uploadImage",ref:"uploadImage",drag:"",limit:1,action:"#","auto-upload":!0,"before-upload":$},{tip:o(()=>[ct]),default:o(()=>[e(g,{class:"el-icon--upload"},{default:o(()=>[e(te)]),_:1}),pt]),_:1},512)]),_:1})]),_:1}))])]),_:1})]),_:1})]),_:1})]),_:1}),e(ae,null,{default:o(()=>[e(se)]),_:1})]),_:1})}}}),Ct=Ie(_t,[["__scopeId","data-v-d01811d8"]]);export{Ct as default};
